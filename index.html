<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="theme-color" content="#0b0a12" />
  <title>üê¶üé≠ Carnario 2026 ‚Äî Rio (Blocos & Festas)</title>

  <style>
    :root{
      --bg0:#060511; --bg1:#0b0a12;
      --card: rgba(255,255,255,.08);
      --stroke: rgba(255,255,255,.14);
      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.70);
      --a:#ffcc00; --b:#ff2ea6; --c:#2ef2ff; --d:#8b5cff; --e:#35ff7a;
      --shadow: 0 18px 60px rgba(0,0,0,.55);
      --r: 22px;
    }
    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      color: var(--text);
      background:
        radial-gradient(1200px 700px at 15% 20%, rgba(255,204,0,.18), transparent 60%),
        radial-gradient(1000px 650px at 85% 30%, rgba(46,242,255,.16), transparent 60%),
        radial-gradient(900px 650px at 45% 90%, rgba(255,46,166,.12), transparent 60%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
      overflow-x:hidden;
    }
    .aurora{
      position:fixed; inset:-30%;
      filter: blur(55px);
      opacity:.85; z-index:-2;
      background: conic-gradient(from 180deg at 50% 50%,
        rgba(255,204,0,.25), rgba(255,46,166,.20), rgba(46,242,255,.18),
        rgba(139,92,255,.18), rgba(53,255,122,.14), rgba(255,204,0,.25));
      animation: spin 14s linear infinite;
    }
    @keyframes spin { to{ transform: rotate(360deg); } }

    .wrap{ min-height:100vh; display:grid; place-items:center; padding:22px 14px 56px; }
    .card{
      width:min(1100px, 100%);
      border-radius: var(--r);
      background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.06));
      border: 1px solid var(--stroke);
      box-shadow: var(--shadow);
      padding: clamp(16px, 3vw, 28px);
      position:relative;
      overflow:hidden;
    }
    header{ display:flex; justify-content:space-between; gap:14px; flex-wrap:wrap; align-items:flex-start; }
    h1{ margin:0; font-size: clamp(26px, 3.6vw, 44px); letter-spacing:-.02em; }
    .subtitle{ color:var(--muted); margin-top:6px; font-size:14px; line-height:1.35; max-width:75ch; }
    .pill{
      display:inline-flex; align-items:center; gap:8px;
      padding:10px 12px; border-radius:999px;
      border:1px solid var(--stroke);
      background: rgba(0,0,0,.18);
      backdrop-filter: blur(10px);
      font-size:13px; color:var(--muted);
      white-space:nowrap;
    }

    .grid{
      margin-top:18px;
      display:grid;
      grid-template-columns: 1.15fr .85fr;
      gap: 14px;
    }
    @media (max-width: 920px){ .grid{ grid-template-columns:1fr; } }

    .panel{
      border-radius: 18px;
      background: rgba(0,0,0,.16);
      border: 1px solid var(--stroke);
      padding: 14px;
    }
    .kpis{ display:grid; grid-template-columns: repeat(4, 1fr); gap: 10px; }
    @media (max-width: 680px){ .kpis{ grid-template-columns: repeat(2, 1fr); } }
    .kpi{
      border-radius: 16px;
      background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.06));
      border: 1px solid var(--stroke);
      padding: 12px;
      text-align:center;
    }
    .kpi .n{
      font-size: clamp(22px, 3vw, 34px);
      font-weight: 900;
      letter-spacing:-.02em;
    }
    .kpi .l{ color:var(--muted); font-size:12px; }

    .barWrap{ margin-top:12px; }
    .bar{
      width:100%; height:12px;
      background: rgba(255,255,255,.10);
      border: 1px solid var(--stroke);
      border-radius: 999px;
      overflow:hidden;
    }
    .bar > div{
      height:100%;
      width:0%;
      background: linear-gradient(90deg, rgba(255,204,0,.95), rgba(255,46,166,.85), rgba(46,242,255,.85));
      border-radius:999px;
      transition: width .5s ease;
    }
    .barMeta{ margin-top:8px; display:flex; justify-content:space-between; color:var(--muted); font-size:12px; }

    .sectionTitle{
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      margin: 0 0 10px;
    }
    .sectionTitle h2{
      margin:0;
      font-size: 16px;
      letter-spacing: .01em;
    }
    .tag{
      padding: 6px 10px;
      border-radius: 999px;
      border:1px solid var(--stroke);
      background: rgba(0,0,0,.16);
      color: var(--muted);
      font-size: 12px;
      white-space:nowrap;
    }

    .list{ display:grid; gap:10px; }
    .item{
      border-radius: 16px;
      border: 1px solid var(--stroke);
      background: rgba(255,255,255,.06);
      padding: 12px;
      display:grid;
      grid-template-columns: 1fr auto;
      gap: 12px;
      align-items:center;
    }
    .item h3{ margin:0; font-size: 15px; }
    .meta{ color: var(--muted); font-size: 12px; margin-top: 3px; line-height:1.35; }
    .actions{ display:flex; gap:8px; flex-wrap:wrap; justify-content:flex-end; }
    .btn{
      cursor:pointer;
      border:1px solid var(--stroke);
      background: rgba(0,0,0,.20);
      color: var(--text);
      padding: 9px 10px;
      border-radius: 12px;
      font-size: 12px;
      transition: transform .15s ease, background .15s ease;
      user-select:none;
      text-decoration:none;
      display:inline-flex;
      align-items:center;
      gap:6px;
    }
    .btn:hover{ transform: translateY(-1px); background: rgba(255,255,255,.10); }
    .btn:active{ transform: translateY(0px); }

    a{ color: rgba(46,242,255,.95); text-decoration:none; }
    a:hover{ text-decoration:underline; }

    .note{
      margin-top:10px;
      font-size: 12px;
      color: var(--muted);
      line-height:1.35;
    }

    footer{
      margin-top: 14px;
      display:flex; flex-wrap:wrap; gap:10px;
      justify-content:space-between; align-items:center;
      color: var(--muted);
      font-size: 12px;
    }
    .miniBtns{ display:flex; gap:8px; flex-wrap:wrap; }

    /* little rio flair */
    .ribbon{
      position:absolute; right:-60px; top:16px;
      transform: rotate(18deg);
      background: linear-gradient(90deg, rgba(255,204,0,.9), rgba(255,46,166,.85), rgba(46,242,255,.85));
      padding:10px 74px;
      border-radius: 999px;
      font-weight:800;
      letter-spacing:.04em;
      font-size:12px;
      color:#0b0a12;
      box-shadow: 0 10px 30px rgba(0,0,0,.35);
      opacity:.95;
    }
  </style>
</head>

<body>
  <div class="aurora" aria-hidden="true"></div>

  <div class="wrap">
    <main class="card">
      <div class="ribbon">RIO ‚Ä¢ BLOCO + FESTA</div>

      <header>
        <div>
          <h1>üê¶üé≠ Carnario 2026 ‚Äî Rio</h1>
          <div class="subtitle">
            Contagem regressiva para <b>13/02/2026</b> (RJ) + agenda essencial: blocos confirmados e as <b>4 festas principais</b>.
            <br/>
            <b>Sem inventar:</b> cada item tem links de refer√™ncia em ‚ÄúFonte / Ingresso‚Äù.
          </div>
        </div>
        <div class="pill" id="nowPill">‚è±Ô∏è Atualizando‚Ä¶</div>
      </header>

      <div class="grid">
        <section class="panel">
          <div class="sectionTitle">
            <h2>‚è≥ Falta para 13/02/2026</h2>
            <span class="tag">TZ: -03:00 (RJ/SP)</span>
          </div>

          <div class="kpis">
            <div class="kpi"><div class="n" id="weeks">‚Äî</div><div class="l">semanas</div></div>
            <div class="kpi"><div class="n" id="days">‚Äî</div><div class="l">dias</div></div>
            <div class="kpi"><div class="n" id="hours">‚Äî</div><div class="l">horas</div></div>
            <div class="kpi"><div class="n" id="mins">‚Äî</div><div class="l">min</div></div>
          </div>

          <div class="barWrap">
            <div class="bar" aria-label="Progresso at√© 13/02/2026">
              <div id="barFill"></div>
            </div>
            <div class="barMeta">
              <span id="progressLeft">‚Äî</span>
              <span id="progressPct">‚Äî%</span>
            </div>
          </div>

          <div class="note">
            Dica: abre no celular e clica ‚ÄúüìÖ Add Calendar‚Äù nos eventos para montar seu roteiro.
          </div>

          <footer>
            <span id="statusLine">Pronto.</span>
            <div class="miniBtns">
              <button class="btn" id="shareBtn">üì§ Compartilhar</button>
              <button class="btn" id="copyBtn">üîó Copiar link</button>
              <button class="btn" id="confettiBtn">üéä Confete</button>
            </div>
          </footer>
        </section>

        <aside class="panel">
          <div class="sectionTitle">
            <h2>‚úÖ Blocos confirmados (2026)</h2>
            <span class="tag">com fonte</span>
          </div>
          <div class="list" id="confirmedBlocks"></div>

          <div class="note">
            Fonte principal dos blocos (agenda 2026): Di√°rio do Rio.
          </div>
        </aside>
      </div>

      <section class="panel" style="margin-top:14px;">
        <div class="sectionTitle">
          <h2>üéüÔ∏è Festas principais (2026)</h2>
          <span class="tag">com links</span>
        </div>

        <div class="list" id="mainParties"></div>

        <div class="note">
          Observa√ß√£o: quando duas fontes divergem em <b>hor√°rio</b>, eu mostro isso no card (sem chutar).
        </div>
      </section>

      <section class="panel" style="margin-top:14px;">
        <div class="sectionTitle">
          <h2>üìö Fontes</h2>
          <span class="tag">transpar√™ncia</span>
        </div>
        <div class="note" id="sourcesBox"></div>
      </section>

    </main>
  </div>

  <canvas id="fx" style="position:fixed;inset:0;pointer-events:none;z-index:10;"></canvas>

  <script>
    // =========================================================
    // CONFIG
    // =========================================================
    const TARGET = new Date("2026-02-13T00:00:00-03:00");
    const START  = new Date("2025-01-01T00:00:00-03:00");

    // Blocos confirmados (agenda 2026) ‚Äî Di√°rio do Rio.
    // (mantive os 3 que j√° estavam confirmados no seu site)
    const CONFIRMED_BLOCKS = [
      {
        kind:"Bloco",
        title: "Areia",
        dt: "2026-02-15T07:00:00-03:00",
        whenLabel: "15/02/2026 (Dom) ‚Äî 07:00",
        where: "Posto 12, Leblon",
        mapsQuery: "Posto 12 Leblon Rio de Janeiro",
        ticketUrl: "https://diariodorio.com/agenda-dos-blocos-de-rua-do-rio-de-janeiro-em-2026/",
        sourceUrl: "https://diariodorio.com/agenda-dos-blocos-de-rua-do-rio-de-janeiro-em-2026/"
      },
      {
        kind:"Bloco",
        title: "Sargento Pimenta",
        dt: "2026-02-16T08:00:00-03:00",
        whenLabel: "16/02/2026 (Seg) ‚Äî 08:00",
        where: "Av. Infante Dom Henrique, 75 (Flamengo)",
        mapsQuery: "Avenida Infante Dom Henrique 75 Flamengo Rio de Janeiro",
        ticketUrl: "https://diariodorio.com/agenda-dos-blocos-de-rua-do-rio-de-janeiro-em-2026/",
        sourceUrl: "https://diariodorio.com/agenda-dos-blocos-de-rua-do-rio-de-janeiro-em-2026/"
      },
      {
        kind:"Bloco",
        title: "Imp√©rio da Cruzada",
        dt: "2026-02-16T14:00:00-03:00",
        whenLabel: "16/02/2026 (Seg) ‚Äî 14:00",
        where: "Av. Delfim Moreira, 12 (Leblon)",
        mapsQuery: "Avenida Delfim Moreira 12 Leblon Rio de Janeiro",
        ticketUrl: "https://diariodorio.com/agenda-dos-blocos-de-rua-do-rio-de-janeiro-em-2026/",
        sourceUrl: "https://diariodorio.com/agenda-dos-blocos-de-rua-do-rio-de-janeiro-em-2026/"
      }
    ];

    // FESTAS PRINCIPAIS (como voc√™ pediu)
    // - Baile do Momo (Domingo)
    // - SubaJovem (Segunda)
    // - Monobloco (Sexta) -> aqui usei "Ensaios do Monobloco" (evento publicado) em 13/02/2026 (sexta)
    // - Black Coffee BOMA (S√°bado) -> 14/02/2026 no Museu do Amanh√£, com diverg√™ncia 21h vs 22h em p√°ginas diferentes
    const MAIN_PARTIES = [
      {
        kind:"Festa",
        title: "Monobloco ‚Äî Ensaios 2026 (sexta)",
        dt: "2026-02-13T21:00:00-03:00",
        whenLabel: "13/02/2026 (Sex) ‚Äî hor√°rio a confirmar no ingresso",
        where: "Fundi√ß√£o Progresso ‚Äî R. dos Arcos, 24, Centro",
        mapsQuery: "Fundi√ß√£o Progresso Rua dos Arcos 24 Rio de Janeiro",
        ticketUrl: "https://ingresse.com/ensaios-do-monobloco-2026-fundicao-progresso/",
        sourceUrl: "https://ingresse.com/ensaios-do-monobloco-2026-fundicao-progresso/",
        note: "Este √© um evento de ensaio (publicado). N√£o achei uma p√°gina aberta confirmando ‚Äúdesfile de rua‚Äù do Monobloco em 2026."
      },
      {
        kind:"Festa",
        title: "BOMA ‚Äî Black Coffee (s√°bado)",
        dt: "2026-02-14T21:00:00-03:00",
        whenLabel: "14/02/2026 (S√°b) ‚Äî 21:00 (ou 22:00, ver fontes)",
        where: "Museu do Amanh√£ ‚Äî Pra√ßa Mau√°, 1, Centro",
        mapsQuery: "Museu do Amanh√£ Pra√ßa Mau√° 1 Rio de Janeiro",
        ticketUrl: "https://ingresse.com/black-coffee-carnival/",
        sourceUrl: "https://www.exiteventos.com.br/event-details/boma-presents-black-coffee-ahmed-spins",
        extraSources: [
          {label:"Fonte (21:00)", url:"https://www.exiteventos.com.br/event-details/boma-presents-black-coffee-ahmed-spins"},
          {label:"Fonte (22:00)", url:"https://betimelapse.com.br/eventos/boma-black-coffee-rj/"}
        ],
        note: "H√° diverg√™ncia p√∫blica de hor√°rio (21h vs 22h). Confirme no ingresso antes de fechar seu roteiro."
      },
      {
        kind:"Festa",
        title: "Baile do Momo (domingo)",
        dt: "2026-02-15T23:00:00-03:00",
        whenLabel: "15/02/2026 (Dom) ‚Äî 23:00 (local pode variar)",
        where: "Rio de Janeiro ‚Äî local a confirmar (depende da organiza√ß√£o)",
        mapsQuery: "Rio de Janeiro",
        ticketUrl: "https://www.ingresse.com/bailedomomo-rj-carnaval/",
        sourceUrl: "https://betimelapse.com.br/eventos/baile-do-momo-carnaval-rj/",
        extraSources: [
          {label:"Fonte (data)", url:"https://betimelapse.com.br/eventos/baile-do-momo-carnaval-rj/"},
          {label:"Fonte (23:00)", url:"https://ondehoje.com.br/evento/baile-do-momo-15.02.2026"}
        ],
        note: "A data (domingo) est√° publicada; j√° vi listagem com 23:00, mas o local aparece como ‚Äúa definir‚Äù em algumas p√°ginas ‚Äî confirme no ingresso."
      },
      {
        kind:"Festa",
        title: "SubaJovem ‚Äî Baile da Purpurina (segunda)",
        dt: "2026-02-16T18:00:00-03:00",
        whenLabel: "16/02/2026 (Seg) ‚Äî 18:00 (pode ter fim 06:00)",
        where: "Rio de Janeiro ‚Äî local a confirmar",
        mapsQuery: "Rio de Janeiro",
        ticketUrl: "https://www.ingresse.com/subajovem-baile-da-purpurina-open-bar-2026/",
        sourceUrl: "https://www.ingresse.com/subajovem-baile-da-purpurina-open-bar-2026/",
        extraSources: [
          {label:"Fonte (Seg 16/02/2026)", url:"https://www.ingresse.com/subajovem-baile-da-purpurina-open-bar-2026/"},
          {label:"Fonte (18:00‚Äì06:00 / local a definir)", url:"https://raentretenimento.com/eventos/ingressos-desconto-suba-jovem-carnaval-rj-2026/"}
        ],
        note: "A data (segunda) est√° na p√°gina do evento; vi p√°gina listando 18:00‚Äì06:00 e local 'a definir'. Confirme no ingresso."
      }
    ];

    // =========================================================
    // UI HELPERS
    // =========================================================
    const $ = (id) => document.getElementById(id);

    function fmtNow() {
      const now = new Date();
      const opts = { weekday:"short", year:"numeric", month:"2-digit", day:"2-digit", hour:"2-digit", minute:"2-digit", second:"2-digit" };
      return now.toLocaleString("pt-BR", opts);
    }

    function openMaps(query){
      const url = "https://www.google.com/maps/search/?api=1&query=" + encodeURIComponent(query);
      window.open(url, "_blank", "noopener,noreferrer");
    }

    async function copyText(text){
      try{
        await navigator.clipboard.writeText(text);
        setStatus("‚úÖ Copiado.");
      }catch{
        setStatus("‚ùå N√£o consegui copiar (permiss√£o do navegador).");
      }
    }

    function setStatus(text){
      $("statusLine").textContent = text;
      clearTimeout(window.__st);
      window.__st = setTimeout(()=> $("statusLine").textContent = "Pronto.", 2500);
    }

    function escapeHtml(s){
      return String(s).replace(/[&<>"']/g, c => ({
        "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"
      }[c]));
    }

    // =========================================================
    // ICS GENERATOR
    // =========================================================
    function pad2(n){ return String(n).padStart(2,"0"); }
    function toICSDate(dt){
      // Use local time as "floating" to avoid timezone bugs on some calendars
      const d = new Date(dt);
      const y = d.getFullYear();
      const m = pad2(d.getMonth()+1);
      const da = pad2(d.getDate());
      const h = pad2(d.getHours());
      const mi = pad2(d.getMinutes());
      const s = pad2(d.getSeconds());
      return `${y}${m}${da}T${h}${mi}${s}`;
    }
    function downloadICS({title, start, location, url}){
      if(!start){
        setStatus("‚ùå Sem data/hor√°rio suficientes para .ics.");
        return;
      }
      const dtStart = toICSDate(start);
      const end = new Date(start.getTime() + 2*60*60*1000); // dura√ß√£o padr√£o 2h (sem inventar: √© s√≥ default t√©cnico)
      const dtEnd = toICSDate(end);

      const ics =
`BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//Carnario 2026//RJ Planner//PT-BR
CALSCALE:GREGORIAN
BEGIN:VEVENT
UID:${Math.random().toString(16).slice(2)}@carnario
DTSTAMP:${toICSDate(new Date())}
DTSTART:${dtStart}
DTEND:${dtEnd}
SUMMARY:${title}
LOCATION:${location || "Rio de Janeiro"}
URL:${url || ""}
END:VEVENT
END:VCALENDAR`;

      const blob = new Blob([ics], {type:"text/calendar;charset=utf-8"});
      const a = document.createElement("a");
      a.href = URL.createObjectURL(blob);
      a.download = (title || "evento").replace(/[^\w\s-]/g,"").replace(/\s+/g,"-").toLowerCase() + ".ics";
      document.body.appendChild(a);
      a.click();
      a.remove();
      setStatus("üìÖ .ics baixado!");
    }

    // =========================================================
    // RENDER
    // =========================================================
    function renderList(rootId, items){
      const root = $(rootId);
      root.innerHTML = "";

      items
        .slice()
        .sort((a,b)=> (new Date(a.dt||"2100-01-01") - new Date(b.dt||"2100-01-01")))
        .forEach((ev) => {
          const div = document.createElement("div");
          div.className = "item";

          const sourcesHtml = (() => {
            const parts = [];
            if (ev.sourceUrl) parts.push(`<a href="${ev.sourceUrl}" target="_blank" rel="noopener noreferrer">Fonte</a>`);
            if (ev.extraSources?.length){
              ev.extraSources.forEach(s => parts.push(`<a href="${s.url}" target="_blank" rel="noopener noreferrer">${escapeHtml(s.label)}</a>`));
            }
            return parts.length ? parts.join(" ¬∑ ") : "";
          })();

          div.innerHTML = `
            <div>
              <h3>${ev.kind === "Festa" ? "üéâ" : "üé∫"} ${escapeHtml(ev.title)}</h3>
              <div class="meta">
                <b>Quando:</b> ${escapeHtml(ev.whenLabel || "A confirmar")}<br/>
                <b>Onde:</b> ${escapeHtml(ev.where || "A confirmar")}<br/>
                ${sourcesHtml ? `<b>Links:</b> ${sourcesHtml}<br/>` : ""}
                ${ev.note ? `<span style="opacity:.92"><b>Obs:</b> ${escapeHtml(ev.note)}</span>` : ""}
              </div>
            </div>
            <div class="actions">
              <button class="btn">üó∫Ô∏è Maps</button>
              <a class="btn" href="${ev.ticketUrl || ev.sourceUrl || "#"}" target="_blank" rel="noopener noreferrer">üéüÔ∏è Ingresso</a>
              <button class="btn">üìÖ Add Calendar</button>
              <button class="btn">üìã Copiar</button>
            </div>
          `;

          const [mapsBtn, , icsBtn, copyBtn] = div.querySelectorAll(".actions .btn");

          mapsBtn.onclick = () => openMaps(ev.mapsQuery || (ev.where + " Rio de Janeiro"));

          icsBtn.onclick = () => {
            const start = ev.dt ? new Date(ev.dt) : null;
            if (!start || isNaN(start.getTime())) {
              setStatus("‚ùå Sem data/hor√°rio suficientes para .ics.");
              return;
            }
            downloadICS({
              title: `${ev.kind}: ${ev.title}`,
              start,
              location: ev.where,
              url: ev.ticketUrl || ev.sourceUrl
            });
          };

          copyBtn.onclick = () => copyText(
            `${ev.kind}: ${ev.title}\nQuando: ${ev.whenLabel}\nOnde: ${ev.where}\nIngresso/Fonte: ${ev.ticketUrl || ev.sourceUrl || ""}`
          );

          root.appendChild(div);
        });
    }

    function renderSources(){
      const sources = [
        {label:"SubaJovem (Ingresse)", url:"https://www.ingresse.com/subajovem-baile-da-purpurina-open-bar-2026/"},
        {label:"SubaJovem (hor√°rio/local a definir ‚Äî RA)", url:"https://raentretenimento.com/eventos/ingressos-desconto-suba-jovem-carnaval-rj-2026/"},
        {label:"BOMA Black Coffee (Exit Eventos ‚Äî 21:00)", url:"https://www.exiteventos.com.br/event-details/boma-presents-black-coffee-ahmed-spins"},
        {label:"BOMA Black Coffee (Timelapse ‚Äî 22:00 / Museu do Amanh√£)", url:"https://betimelapse.com.br/eventos/boma-black-coffee-rj/"},
        {label:"Baile do Momo (Timelapse ‚Äî domingo 15/02)", url:"https://betimelapse.com.br/eventos/baile-do-momo-carnaval-rj/"},
        {label:"Baile do Momo (OndeHoje ‚Äî 23:00)", url:"https://ondehoje.com.br/evento/baile-do-momo-15.02.2026"},
        {label:"Monobloco (Ensaios 2026 ‚Äî Ingresse)", url:"https://ingresse.com/ensaios-do-monobloco-2026-fundicao-progresso/"},
        {label:"Fundi√ß√£o Progresso (endere√ßo)", url:"https://www.fundicaoprogresso.com.br/programacao/Show/118"},
        {label:"Blocos RJ 2026 (Di√°rio do Rio)", url:"https://diariodorio.com/agenda-dos-blocos-de-rua-do-rio-de-janeiro-em-2026/"}
      ];

      $("sourcesBox").innerHTML = sources.map(s =>
        `‚Ä¢ <a href="${s.url}" target="_blank" rel="noopener noreferrer">${escapeHtml(s.label)}</a>`
      ).join("<br/>");
    }

    // =========================================================
    // COUNTDOWN
    // =========================================================
    function tick(){
      const now = new Date();
      $("nowPill").textContent = "‚è±Ô∏è Agora: " + fmtNow();

      let diff = TARGET - now;
      if (diff < 0) diff = 0;

      const totalSeconds = Math.floor(diff/1000);
      const totalMinutes = Math.floor(totalSeconds/60);
      const totalHours   = Math.floor(totalMinutes/60);
      const totalDays    = Math.floor(totalHours/24);
      const weeks = Math.floor(totalDays/7);
      const days  = totalDays % 7;
      const hours = totalHours % 24;
      const mins  = totalMinutes % 60;

      $("weeks").textContent = weeks;
      $("days").textContent  = days;
      $("hours").textContent = hours;
      $("mins").textContent  = mins;

      // progress bar
      const span = TARGET - START;
      const done = now - START;
      const pct  = Math.max(0, Math.min(1, done / span));
      $("barFill").style.width = (pct*100).toFixed(2) + "%";
      $("progressPct").textContent = (pct*100).toFixed(1) + "%";

      const daysLeftTotal = Math.ceil((TARGET - now)/(1000*60*60*24));
      $("progressLeft").textContent = (daysLeftTotal > 0 ? `${daysLeftTotal} dias restantes` : "√â HOJE!");
    }

    // =========================================================
    // CONFETTI FX
    // =========================================================
    const canvas = document.getElementById("fx");
    const ctx = canvas.getContext("2d");
    let particles = [];
    function resize(){
      canvas.width = innerWidth * devicePixelRatio;
      canvas.height = innerHeight * devicePixelRatio;
      canvas.style.width = innerWidth + "px";
      canvas.style.height = innerHeight + "px";
      ctx.setTransform(devicePixelRatio,0,0,devicePixelRatio,0,0);
    }
    addEventListener("resize", resize);
    resize();

    function popConfetti(){
      const n = 170;
      for (let i=0;i<n;i++){
        particles.push({
          x: Math.random()*innerWidth,
          y: -10,
          vx: (Math.random()-0.5)*2.4,
          vy: 2.2 + Math.random()*3.3,
          r: 2 + Math.random()*4.2,
          rot: Math.random()*Math.PI*2,
          vr: (Math.random()-0.5)*0.25,
          life: 190 + Math.random()*140
        });
      }
      setStatus("üéä Confete!");
    }

    function animate(){
      ctx.clearRect(0,0,innerWidth,innerHeight);
      particles = particles.filter(p => p.life-- > 0);
      for (const p of particles){
        p.x += p.vx;
        p.y += p.vy;
        p.rot += p.vr;
        p.vy += 0.012;
        ctx.save();
        ctx.translate(p.x,p.y);
        ctx.rotate(p.rot);
        ctx.fillStyle = `hsla(${(p.life*3.2)%360}, 95%, 60%, .9)`;
        ctx.fillRect(-p.r, -p.r, p.r*2.4, p.r*1.3);
        ctx.restore();
      }
      requestAnimationFrame(animate);
    }
    animate();

    // =========================================================
    // SHARE / COPY
    // =========================================================
    document.getElementById("copyBtn").onclick = () => copyText(location.href);

    document.getElementById("shareBtn").onclick = async () => {
      if (navigator.share){
        try{
          await navigator.share({ title: document.title, text: "Carnario 2026 ‚Äî RJ (blocos + festas)", url: location.href });
          setStatus("üì§ Compartilhado!");
        }catch{
          setStatus("‚ùå Share cancelado.");
        }
      } else {
        copyText(location.href);
        setStatus("Seu navegador n√£o tem Share ‚Äî copiei o link.");
      }
    };

    document.getElementById("confettiBtn").onclick = popConfetti;

    // init
    renderList("confirmedBlocks", CONFIRMED_BLOCKS);
    renderList("mainParties", MAIN_PARTIES);
    renderSources();
    tick();
    setInterval(tick, 1000);
  </script>
</body>
</html>

